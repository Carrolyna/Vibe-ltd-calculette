function save(e,t){localStorage.setItem(e,JSON.stringify(t))}function load(e,t){try{return JSON.parse(localStorage.getItem(e))??t}catch{return t}}function round2(e){return Math.round(100*Number(e))/100}function fmt(e){return`${Number(e).toFixed(2)}$`}function escapeHtml(e){return String(e).replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"}[e]))}let activePage=load("ltd_active_page","sale");function setPage(e){activePage=e,save("ltd_active_page",activePage),document.querySelectorAll("#pages .chip").forEach(t=>{t.classList.toggle("active",t.dataset.page===e)}),document.getElementById("page-sale").style.display="sale"===e?"":"none",document.getElementById("page-shopping").style.display="shopping"===e?"":"none";const t="sale"===e;document.getElementById("saleControls").style.display=t?"":"none",document.getElementById("saleTabsRow").style.display=t?"":"none","sale"===e&&renderAllSale(),"shopping"===e&&onEnterShopping()}document.getElementById("pages").addEventListener("click",e=>{const t=e.target.closest("[data-page]");t&&setPage(t.dataset.page)});const CATEGORIES=[{id:"ALL",label:"Tout"},{id:"BOISSONS",label:"Boissons"},{id:"FRITEUSES",label:"Friteuses"},{id:"PLAQUES",label:"Plaques"},{id:"MENUS",label:"Menus"},{id:"ENTREPRISE",label:"Entreprise"},{id:"RACHAT",label:"Rachat"},{id:"DETAILS",label:"D√©tails"}],ITEMS=[{id:"jus_orange",name:"Jus d'orange",price:40,category:"BOISSONS",img:"assets/items/jus_orange.png"},{id:"jus_pomme",name:"Jus de pomme",price:40,category:"BOISSONS",img:"assets/items/jus_pomme.png"},{id:"jus_raisin",name:"Jus raisin",price:40,category:"BOISSONS",img:"assets/items/jus_raisin.png"},{id:"jus_tomate",name:"Jus de tomate",price:50,category:"BOISSONS",img:"assets/items/jus_tomate.png"},{id:"soda",name:"Soda",price:70,category:"BOISSONS",img:"assets/items/soda.png"},{id:"the_glace",name:"Th√© glac√©",price:70,category:"BOISSONS",img:"assets/items/the_glace.png"},{id:"smoothie",name:"Smoothie",price:70,category:"BOISSONS",img:"assets/items/smoothie.png"},{id:"glace",name:"Glace",price:50,category:"BOISSONS",img:"assets/items/glace.png"},{id:"verre_lait",name:"Verre de lait",price:60,category:"BOISSONS",img:"assets/items/verre_lait.png"},{id:"milkshake",name:"Milkshake",price:60,category:"BOISSONS",img:"assets/items/milkshake.png"},{id:"poche_glace",name:"Poche de glace",price:45,category:"BOISSONS",img:"assets/items/icepack.png"},{id:"frite",name:"Frites",price:30,category:"FRITEUSES",img:"assets/items/frites.png"},{id:"potatoes",name:"Potatoes",price:50,category:"FRITEUSES",img:"assets/items/potatoes.png"},{id:"fish_chips",name:"Fish & Chips",price:70,category:"FRITEUSES",img:"assets/items/fish_chips.png"},{id:"tenders",name:"Tenders",price:80,category:"FRITEUSES",img:"assets/items/tenders.png"},{id:"classic_burger",name:"Classic burger",price:90,category:"PLAQUES",img:"assets/items/menu_classic_burger.png"},{id:"fish_burger",name:"Fish burger",price:90,category:"PLAQUES",img:"assets/items/menu_fish_burger.png"},{id:"le_gros",name:"Le gros",price:105,category:"PLAQUES",img:"assets/items/menu_burger_gros.png"},{id:"chicken_burger",name:"Chicken burger",price:90,category:"PLAQUES",img:"assets/items/menu_chicken_burger.png"},{id:"ratatouille",name:"Ratatouille",price:70,category:"PLAQUES",img:"assets/items/ratatouille.png"},{id:"salade_fraiche",name:"Salade fra√Æche",price:70,category:"PLAQUES",img:"assets/items/salade_mixed.png"},{id:"aubergine_farcie",name:"Aubergine farcie",price:90,category:"PLAQUES",img:"assets/items/aubergine_farcie.png"},{id:"saucisson",name:"Saucisson",price:110,category:"PLAQUES",img:"assets/items/planchesaucisson.png"},{id:"hotdog",name:"Hot-Dog",price:70,category:"PLAQUES",img:"assets/items/hot_dog.png"},{id:"sucette",name:"Sucette",price:30,category:"PLAQUES",img:"assets/items/sucette.png"},{id:"menu_starter",name:"Menu ‚Ä¢ Starter",price:450,category:"MENUS",img:"assets/items/menu_classic_burger.png",contains:"4 plats + 4 boissons"},{id:"menu_healthy",name:"Menu ‚Ä¢ Healthy & Chill",price:600,category:"MENUS",img:"assets/items/salade_mixed.png",contains:"5 salades / aubergines / ratatouilles + 6 jus"},{id:"menu_gros_daleux",name:"Menu ‚Ä¢ Gros Daleux",price:800,category:"MENUS",img:"assets/items/menu_burger_gros.png",contains:"7 plats + 7 boissons"},{id:"menu_colonel",name:"Menu ‚Ä¢ Le Colonel",price:700,category:"MENUS",img:"assets/items/tenders.png",contains:"5 tenders + 5 boissons"},{id:"pro_joe",name:"Joe le Taxi",price:800,category:"ENTREPRISE",img:"assets/Logos Entreprises/Taxi/ico_taxi.png",bill:"PRO",pack:{plats:7,boissons:7},contains:"7 plats au choix + 7 boissons au choix"},{id:"pro_sugar",name:"Sugar",price:1e3,category:"ENTREPRISE",img:"assets/Logos Entreprises/doj.png",bill:"PRO",pack:{plats:10,boissons:10},contains:"10 plats au choix + 10 boissons au choix"},{id:"pro_columbo",name:"Columbo",price:600,category:"ENTREPRISE",img:"assets/Logos Entreprises/LSPD/ico_LSPD.png",bill:"PRO",pack:{plats:6,boissons:6},contains:"6 plats au choix + 6 boissons au choix"},{id:"pro_deux_tonnes",name:"Deux-Tonnes",price:1e3,category:"ENTREPRISE",img:"assets/Logos Entreprises/Sheriff/ico_sheriff.png",bill:"PRO",pack:{plats:10,boissons:10},contains:"10 plats au choix + 10 boissons au choix"},{id:"perso_cookie",name:"Cookie",price:700,category:"ENTREPRISE",img:"assets/Logos Entreprises/Weazel News/ico_weazle_news.png",bill:"PERSO",pack:{plats:6,boissons:6},contains:"6 plats au choix + 6 boissons au choix"},{id:"perso_faggio",name:"Faggio",price:700,category:"ENTREPRISE",img:"assets/Logos Entreprises/LS Auto Repair/ico_LS_auto_repair.png",bill:"PERSO",contains:"6 plats + 6 boissons",service10:!0},{id:"collab_bourvil",name:"Bourvil (The Finds)",price:350,category:"ENTREPRISE",img:"assets/Logos Entreprises/thefinds.png",pack:{plats:4,boissons:4},contains:"4 Aubergines Farcies + 4 Jus de Tomate"},{id:"pro_cash_in",name:"CASH IN ! (3x/j)",price:800,category:"ENTREPRISE",img:"assets/Logos Entreprises/Gruppe 6/ico_gruppe6.png",bill:"PRO",contains:"7 plats + 7 boissons",service10:!0},{id:"pro_pumba",name:"PUMBA",price:750,category:"ENTREPRISE",img:"assets/Logos Entreprises/Raven/ico_raven.png",bill:"PRO",pack:{plats:7,boissons:7},contains:"7 plats au choix + 7 boissons au choix"},{id:"pro_redstone",name:"REDSTONE",price:800,category:"ENTREPRISE",img:"assets/Logos Entreprises/Davis Quartz/ico_davis_quartz.png",bill:"PRO",pack:{plats:7,boissons:7},contains:"7 plats au choix + 7 boissons au choix"},{id:"pro_stardew",name:"STARDDEW",price:800,category:"ENTREPRISE",img:"assets/Logos Entreprises/Shady Tree/ico_shady_tree.png",bill:"PRO",pack:{plats:7,boissons:7},contains:"7 plats au choix + 7 boissons au choix"},{id:"pro_pompelop",name:"POMPELOP !",price:1e3,category:"ENTREPRISE",img:"assets/Logos Entreprises/Ron/ico_ron.png",bill:"PRO",pack:{plats:10,boissons:10},contains:"10 plats au choix + 10 boissons au choix"},{id:"pro_valorant",name:"VALORANT",price:800,category:"ENTREPRISE",img:"assets/Logos Entreprises/Neon Mechanic/ico_neon_mechanic.png",bill:"PRO",pack:{plats:7,boissons:7},contains:"7 plats au choix + 7 boissons au choix"},{id:"rachat_poisson",name:"Rachat ‚Ä¢ Poisson",price:20,category:"RACHAT",img:"assets/items/poisson_cru.png"},{id:"rachat_soda",name:"Rachat ‚Ä¢ Soda",price:32,category:"RACHAT",img:"assets/items/soda.png"},{id:"rachat_eau",name:"Rachat ‚Ä¢ Bouteille d'eau",price:12,category:"RACHAT",img:"assets/items/water.png"},{id:"canne_peche",name:"Canne √† p√™che",price:250,category:"DETAILS",img:"assets/items/canne_peche.png"},{id:"ciseaux",name:"Ciseaux",price:150,category:"DETAILS",img:"assets/items/ciseaux.png"},{id:"pince_coupante",name:"Pince coupante",price:180,category:"DETAILS",img:"assets/items/pince_coupante.png"},{id:"pot",name:"Pot",price:45,category:"DETAILS",img:"assets/items/pot.png"},{id:"sac_papier",name:"Sac en papier",price:60,category:"DETAILS",img:"assets/items/sac_papier.png"},{id:"telephone",name:"T√©l√©phone",price:950,category:"DETAILS",img:"assets/items/phone.png"},{id:"jumelles",name:"Jumelles",price:1400,category:"DETAILS",img:"assets/items/jumelles.png"},{id:"parapluie",name:"Parapluie",price:1500,category:"DETAILS",img:"assets/items/parapluie.png"},{id:"trousseau_cles",name:"Trousseau de cl√©s",price:500,category:"DETAILS",img:"assets/items/trousseau_cles.png"},{id:"portefeuille",name:"Portefeuille",price:500,category:"DETAILS",img:"assets/items/portefeuille.png"},{id:"leurre_poisson",name:"Leurre pour poisson",price:12,category:"DETAILS",img:"assets/items/leurre_poisson.png"},{id:"papier_rouler",name:"Papier √† rouler",price:30,category:"DETAILS",img:"assets/items/papier_rouler.png"},{id:"marteau_piqueur",name:"Marteau piqueur",price:1400,category:"DETAILS",img:"assets/items/marteau_piqueur.png"},{id:"classeur",name:"Classeur",price:500,category:"DETAILS",img:"assets/items/classeur.png"},{id:"jerrican",name:"Jerrican",price:180,category:"DETAILS",img:"assets/items/jerrican.png"},{id:"bache",name:"B√¢che",price:60,category:"DETAILS",img:"assets/items/bache.png"},{id:"boite_outils",name:"Bo√Æte √† outils",price:400,category:"DETAILS",img:"assets/items/boite_outils.png"}];let qtyMult=1,activeCat=load("ltd_active_cat","ALL"),cart=load("ltd_cart",{}),discountMode=load("ltd_discount","NONE");const tabsEl=document.getElementById("tabs"),gridEl=document.getElementById("grid"),cartBodyEl=document.getElementById("cartBody"),totalEl=document.getElementById("total"),totalHintEl=document.getElementById("totalHint");function renderTabs(){tabsEl.innerHTML=CATEGORIES.map(e=>`<button class="chip ${e.id===activeCat?"active":""}" data-cat="${e.id}">${e.label}</button>`).join(""),tabsEl.onclick=e=>{const t=e.target.closest("[data-cat]");t&&(activeCat=t.dataset.cat,save("ltd_active_cat",activeCat),tabsEl.querySelectorAll(".chip").forEach(e=>e.classList.remove("active")),t.classList.add("active"),renderAllSale())}}function wireQtyButtons(){const e=document.getElementById("qtyButtons");e.addEventListener("click",t=>{const i=t.target.closest("[data-mult]");i&&(qtyMult=Number(i.dataset.mult),e.querySelectorAll(".chip").forEach(e=>e.classList.remove("active")),i.classList.add("active"))})}function wireDiscountButtons(){const e=document.getElementById("discountButtons");setDiscountUI(discountMode),e.addEventListener("click",e=>{const t=e.target.closest("[data-discount]");t&&("SERVICE_10"!==t.dataset.discount||hasServiceEligibleInCart())&&(discountMode=t.dataset.discount,save("ltd_discount",discountMode),setDiscountUI(discountMode),updateTotalsOnly())})}function setDiscountUI(e){document.querySelectorAll("#discountButtons .chip").forEach(t=>{t.classList.toggle("active",t.dataset.discount===e)})}function renderAllSale(){renderGrid(),renderCart(),updateDiscountAvailability()}function renderGrid(){const e=ITEMS.filter(e=>"ALL"===activeCat||e.category===activeCat);gridEl.innerHTML=e.map(e=>{const t=cart[e.id]||0,i=e.img||"assets/items/_default.png",s="PRO"===e.bill?'<div class="billTag pro">PRO</div>':"PERSO"===e.bill?'<div class="billTag perso">PERSO</div>':"",a=e.service10?'<div class="serviceBadge">-10% service</div>':"",n="MENUS"!==e.category&&"ENTREPRISE"!==e.category||!e.contains?"":`<div class="itemContains" title="${escapeHtml(e.contains)}">${escapeHtml(e.contains)}</div>`;return`\n      <div class="item cat-${e.category}" data-id="${e.id}">\n        ${s}\n        ${a}\n        ${t?`<div class="badge">${t}</div>`:""}\n        <img src="${i}" alt="${escapeHtml(e.name)}" />\n        <div class="itemName" title="${escapeHtml(e.name)}">${escapeHtml(e.name)}</div>\n        ${n}\n        <div class="itemPrice">${fmt(e.price)}</div>\n      </div>\n    `}).join(""),gridEl.querySelectorAll(".item").forEach(e=>{const t=e.dataset.id;e.addEventListener("click",()=>addToCart(t,qtyMult)),e.addEventListener("contextmenu",e=>{e.preventDefault(),e.stopPropagation();(cart[t]||0)<=0||addToCart(t,-qtyMult)})})}function renderCart(){const e=Object.entries(cart);if(!e.length)return cartBodyEl.innerHTML='<div style="color:var(--muted)">Panier vide.</div>',totalEl.textContent=fmt(0),void updateDiscountAvailability();cartBodyEl.innerHTML=e.map(([e,t])=>{const i=ITEMS.find(t=>t.id===e);if(!i)return"";const s=i.price*t;return`\n      <div class="cartRow" data-line="${e}">\n        <div class="cartTop">\n          <div>\n            <div class="cartName">${escapeHtml(i.name)}</div>\n            <div class="cartSub">${escapeHtml(i.category)} ‚Ä¢ ${fmt(i.price)}/u</div>\n          </div>\n\n          <input class="qtyInput" type="number" min="0" step="1" value="${t}" />\n\n          <div class="lineTotal" data-linetotal>${fmt(s)}</div>\n        </div>\n\n        <div class="cartActions">\n          <button class="btn" data-act="inc">+1</button>\n          <button class="btn" data-act="dec">-1</button>\n          <button class="btn danger" data-act="del">üóë</button>\n        </div>\n      </div>\n    `}).join(""),cartBodyEl.querySelectorAll(".cartRow").forEach(e=>{const t=e.dataset.line,i=ITEMS.find(e=>e.id===t),s=e.querySelector(".qtyInput"),a=e.querySelector("[data-linetotal]");s.addEventListener("input",()=>{const e=Number(s.value);if(!Number.isFinite(e)||e<0)return;const n=Math.floor(e);n<=0?delete cart[t]:cart[t]=n,a&&i&&(a.textContent=fmt(i.price*(cart[t]||0))),saveAllSale(),updateTotalsOnly()}),e.querySelectorAll("button[data-act]").forEach(e=>{e.addEventListener("click",()=>{const i=e.dataset.act;"inc"===i&&addToCart(t,1),"dec"===i&&addToCart(t,-1),"del"===i&&setCartQty(t,0)})})}),updateTotalsOnly()}function updateTotalsOnly(){let e=0;for(const[t,i]of Object.entries(cart)){const s=ITEMS.find(e=>e.id===t);s&&(e+=s.price*i)}const t=computeTotalWithDiscount(e);totalEl.textContent=fmt(t),updateDiscountAvailability()}function computeTotalWithDiscount(e){if("NONE"===discountMode)return round2(e);if("SERVICE_10"===discountMode){let e=0,t=0;return Object.entries(cart).forEach(([i,s])=>{const a=ITEMS.find(e=>e.id===i);if(!a)return;const n=a.price*s;!0===a.service10?e+=n:t+=n}),round2(.9*e+t)}if("TUESDAY_COLONEL"===discountMode){const t="menu_colonel",i=cart[t]||0;if(!i)return round2(e);const s=ITEMS.find(e=>e.id===t).price*i;return round2(e-s+.85*s)}return round2(e)}function hasServiceEligibleInCart(){return Object.keys(cart).some(e=>{const t=ITEMS.find(t=>t.id===e);return!0===t?.service10})}function updateDiscountAvailability(){const e=hasServiceEligibleInCart(),t=document.querySelector('#discountButtons [data-discount="SERVICE_10"]');t&&(t.classList.toggle("disabled",!e),t.setAttribute("aria-disabled",String(!e))),"SERVICE_10"!==discountMode||e||(discountMode="NONE",save("ltd_discount",discountMode),setDiscountUI(discountMode)),totalHintEl&&(totalHintEl.innerHTML="SERVICE_10"===discountMode?"‚úÖ <strong>-10% service</strong> appliqu√© uniquement sur <strong>Faggio</strong> & <strong>Gruppe 6</strong>.":e?"‚ÑπÔ∏è <strong>-10% service</strong> possible sur <strong>Faggio</strong> & <strong>Gruppe 6</strong>.":"‚ÑπÔ∏è <strong>-10% service</strong> dispo seulement pour <strong>Faggio</strong> & <strong>Gruppe 6</strong>.")}function addToCart(e,t){const i=(cart[e]||0)+t;i<=0?delete cart[e]:cart[e]=i,saveAllSale(),renderAllSale()}function setCartQty(e,t){t<=0?delete cart[e]:cart[e]=t,saveAllSale(),renderAllSale()}function saveAllSale(){save("ltd_cart",cart),save("ltd_discount",discountMode),save("ltd_active_cat",activeCat)}renderTabs(),wireQtyButtons(),wireDiscountButtons(),document.getElementById("clearCart").addEventListener("click",()=>{cart={},discountMode="NONE",saveAllSale(),setDiscountUI(discountMode),renderAllSale()});const SUPPLIERS=["Dollar Pills","Shady Tree","Raven","Davis Quartz","Ron"],TRUCKS=[{name:"Speedo Framboise",cap:175},{name:"Speedo Gold",cap:175},{name:"Speedo Kirby",cap:175}],RAW_ITEMS=[{id:"eau",name:"Bouteille d'eau",price:15,weight:.5,img:"assets/items/water.png",suppliers:["Dollar Pills"]},{id:"farine",name:"Farine",price:10,weight:.5,img:"assets/items/farine.png",suppliers:["Dollar Pills"]},{id:"brut_sucre",name:"Sucre",price:10,weight:.5,img:"assets/items/brut_sucre.png",suppliers:["Dollar Pills"]},{id:"legume_poivron",name:"Poivron",price:5,weight:.25,img:"assets/items/legume_poivron.png",suppliers:["Dollar Pills"]},{id:"legume_aubergine",name:"Aubergine",price:5,weight:.25,img:"assets/items/legume_aubergine.png",suppliers:["Dollar Pills"]},{id:"pain",name:"Pain",price:5,weight:.15,img:"assets/items/pain.png",suppliers:["Dollar Pills"]},{id:"lighter",name:"Briquet",price:500,weight:.2,img:"assets/items/briquet.png",suppliers:["Dollar Pills"]},{id:"oil",name:"Huile",price:150,weight:1,img:"assets/items/huile.png",suppliers:["Dollar Pills"]},{id:"filtreair",name:"Filtre √† air",price:150,weight:1,img:"assets/items/filtreair.png",suppliers:["Dollar Pills"]},{id:"feuille_papier",name:"Feuille de papier",price:10,weight:.5,img:"assets/items/feuille_papier.png",suppliers:["Dollar Pills"]},{id:"fruit_pomme",name:"Pomme",price:5,weight:0,img:"assets/items/fruit_pomme.png",suppliers:["Shady Tree"]},{id:"brut_salade",name:"Salade",price:8,weight:0,img:"assets/items/brut_salade.png",suppliers:["Shady Tree"]},{id:"legume_tomato",name:"Tomate",price:7,weight:0,img:"assets/items/legume_tomato.png",suppliers:["Shady Tree"]},{id:"legume_potato",name:"Patate",price:9,weight:0,img:"assets/items/legume_potato.png",suppliers:["Shady Tree"]},{id:"fruit_raisin",name:"Raisin",price:9,weight:0,img:"assets/items/fruit_raisin.png",suppliers:["Shady Tree"]},{id:"fruit_orange",name:"Orange",price:9,weight:0,img:"assets/items/fruit_orange.png",suppliers:["Shady Tree"]},{id:"brut_lait",name:"Lait",price:8,weight:0,img:"assets/items/brut_lait.png",suppliers:["Raven"]},{id:"brut_fromage",name:"Fromage",price:8,weight:0,img:"assets/items/brut_fromage.png",suppliers:["Raven"]},{id:"brut_steak",name:"Viande",price:26,weight:0,img:"assets/items/brut_steak.png",suppliers:["Raven"]},{id:"filet_poulet",name:"Poulet",price:26,weight:0,img:"assets/items/filet_poulet.png",suppliers:["Raven"]},{id:"iron_plate",name:"Plaque de fer",price:60,weight:0,img:"assets/items/iron_plate.png",suppliers:["Davis Quartz"]},{id:"gold_plate",name:"Plaque d'or",price:320,weight:0,img:"assets/items/gold_plate.png",suppliers:["Davis Quartz"]},{id:"copper_plate",name:"Plaque de cuivre",price:100,weight:0,img:"assets/items/copper_plate.png",suppliers:["Davis Quartz"]},{id:"plastic",name:"Plastique",price:20,weight:0,img:"assets/items/plastic.png",suppliers:["Ron"]},{id:"jerrican",name:"Jerrican",price:90,weight:0,img:"assets/items/jerrican.png",suppliers:["Ron"]}];let shoppingInitDone=!1,activeSupplier=load("ltd_shop_supplier","Dollar Pills"),shoppingCart=loadShopCart(activeSupplier);function shopKey(e){return"ltd_shopping_cart__"+e.replace(/\s+/g,"_").toLowerCase()}function loadShopCart(e){return load(shopKey(e),{})}function saveShopCart(e,t){save(shopKey(e),t)}function onEnterShopping(){shoppingInitDone||(initShoppingUI(),shoppingInitDone=!0),renderShopping()}function initShoppingUI(){const e=document.getElementById("shopSupplier");e.innerHTML=SUPPLIERS.map(e=>`<option value="${e}">${e}</option>`).join(""),e.value=activeSupplier,e.onchange=()=>{activeSupplier=e.value,save("ltd_shop_supplier",activeSupplier),shoppingCart=loadShopCart(activeSupplier),renderShopping(),toggleWeightUI()},document.getElementById("copyShoppingMsg").addEventListener("click",copyShoppingMessage),document.getElementById("shopReset").addEventListener("click",()=>{shoppingCart={},saveShopCart(activeSupplier,shoppingCart),renderShopping()})}function renderShopping(){const e=document.getElementById("shoppingList"),t=RAW_ITEMS.filter(e=>!e.suppliers||e.suppliers.includes(activeSupplier));let i=0,s=0;e.innerHTML=t.map(e=>{const t=shoppingCart[e.id]||0;return i+=t*e.price,s+=t*e.weight,`\n    <div class="shopRow">\n        <div class="shopRowTop" style="grid-template-columns:70px 1fr 140px;">\n        <div style="display:flex;align-items:center;justify-content:center;">\n            <img src="${e.img}" alt="${escapeHtml(e.name)}"\n                style="width:46px;height:46px;object-fit:contain;" />\n        </div>\n\n        <div>\n            <div class="cartName">${escapeHtml(e.name)}</div>\n            <div class="shopMeta">$${e.price} / unit√©</div>\n        </div>\n\n        <input class="qtyInput" type="number" min="0" step="1"\n                value="${t}" data-rawid="${e.id}" />\n        </div>\n    </div>\n    `}).join(""),e.querySelectorAll(".qtyInput").forEach(e=>{e.addEventListener("input",()=>{const t=e.dataset.rawid,i=Math.floor(Number(e.value));!i||i<=0?delete shoppingCart[t]:shoppingCart[t]=i,saveShopCart(activeSupplier,shoppingCart),recalcShoppingTotals()})}),setShopTotals(i,s),renderTruckLoad(s),saveShopCart(activeSupplier,shoppingCart),toggleWeightUI()}function recalcShoppingTotals(){const e=RAW_ITEMS.filter(e=>!e.suppliers||e.suppliers.includes(activeSupplier));let t=0,i=0;for(const s of e){const e=shoppingCart[s.id]||0;t+=e*s.price,"Dollar Pills"===activeSupplier&&(i+=e*s.weight)}setShopTotals(t,i),renderTruckLoad(i),toggleWeightUI()}function setShopTotals(e,t){document.getElementById("shoppingTotalBig").textContent=`$${e.toFixed(0)}`,document.getElementById("shoppingWeight").textContent=`${t.toFixed(3)}`}function renderTruckLoad(e){if("Dollar Pills"!==activeSupplier)return;let t=e;const i=[];for(const e of TRUCKS){const s=Math.min(e.cap,t);t-=s,i.push(s)}document.getElementById("t1").textContent=i[0].toFixed(3),document.getElementById("t2").textContent=i[1].toFixed(3),document.getElementById("t3").textContent=i[2].toFixed(3);const s=document.getElementById("shoppingWarn");s.style.display=t>0?"":"none"}function copyShoppingMessage(){const e=RAW_ITEMS.filter(e=>!e.suppliers||e.suppliers.includes(activeSupplier)).filter(e=>shoppingCart[e.id]).map(e=>`${shoppingCart[e.id]} ${e.name.toLowerCase()}`),t=`Bonjour, C‚Äôest le LTD de Mirror Park. Vous √™tes disponible pour une livraison de ${e.length?e.join(", "):"aucun article"} svp ? Merci √† vous !`;navigator.clipboard.writeText(t),alert("Message copi√© !")}function toggleWeightUI(){const e="Dollar Pills"===activeSupplier;document.querySelector(".shopTrucks").style.display=e?"":"none",e&&(document.getElementById("shoppingWarn").style.display="none")}setPage(activePage);